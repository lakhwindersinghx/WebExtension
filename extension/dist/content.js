let s=Date.now();function d(){const e=window.scrollY,t=document.body.scrollHeight-window.innerHeight,n=t?e/t*100:0;return Math.min(100,Math.max(0,n))}function u(e){const t=new URL(e).hostname;return t.includes("youtube")||t.includes("netflix")?"entertainment":t.includes("linkedin")||t.includes("glassdoor")?"job search":t.includes("google")||t.includes("wikipedia")?"research":t.includes("instagram")||t.includes("twitter")?"social media":"other"}function c(){const e=d(),t=document.title,n=window.location.href,o=Date.now(),r=Math.round((o-s)/1e3),i=u(n),a=new Date().toISOString();r<3||(fetch("http://localhost:8000/track-event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tab_url:n,title:t,scroll_depth:e,duration_seconds:r,category:i,timestamp:a})}).catch(l=>console.error("Failed to send event:",l)),s=o)}function h(){setInterval(c,1e4),c()}function f(e){let t=Date.now();const n=3e5;let o=!1;function r(){t=Date.now()}["mousemove","keydown","mousedown","scroll"].forEach(i=>window.addEventListener(i,r)),setInterval(()=>{const i=Date.now()-t;!o&&i>n?(o=!0,e("start")):o&&i<=n&&(o=!1,e("end"))},1e4)}h();f();
